# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Defined types

* [`puppet_authorization`](#puppet_authorization): Sets up the skeleton server `auth.conf` file if it doesn't exist
* [`puppet_authorization::rule`](#puppet_authorizationrule): Adds/removes individual rules in `auth.conf`

### Resource types

* [`puppet_authorization_hocon_rule`](#puppet_authorization_hocon_rule): An arbitrary name used as the identity of the resource.

### Data types

* [`Puppet_authorization::Httpmethod`](#puppet_authorizationhttpmethod): HTTP method to authorize (`get`, `post`, etc.,)

## Defined types

### <a name="puppet_authorization"></a>`puppet_authorization`

Sets up the skeleton server `auth.conf` file if it doesn't exist

#### Examples

##### 

```puppet

puppet_authorization { '/etc/puppetlabs/puppetserver/conf.d/auth.conf':
  version                => 1,
  allow_header_cert_info => false
}
```

#### Parameters

The following parameters are available in the `puppet_authorization` defined type:

* [`version`](#version)
* [`allow_header_cert_info`](#allow_header_cert_info)
* [`replace`](#replace)
* [`path`](#path)

##### <a name="version"></a>`version`

Data type: `Integer`

The `authorization.version` setting in the server auth.conf.
Valid options: an integer (currently, 1 is the only supported value).

Default value: `1`

##### <a name="allow_header_cert_info"></a>`allow_header_cert_info`

Data type: `Boolean`

The `authorization.allow-header-cert-info` setting in the server auth.conf

Default value: ``false``

##### <a name="replace"></a>`replace`

Data type: `Boolean`

Whether or not to replace existing file at `path`. If set to true this will
cause the file to be regenerated on every puppet run

Default value: ``false``

##### <a name="path"></a>`path`

Data type: `Stdlib::Absolutepath`

Absolute path for `auth.conf`

Default value: `$name`

### <a name="puppet_authorizationrule"></a>`puppet_authorization::rule`

Adds/removes individual rules in `auth.conf`

#### Examples

##### Grant (only) `'your.special.admin'` access to the `/puppet/v3/environments` endpoint

```puppet

puppet_authorization::rule { 'environments':
  match_request_path         => '/puppet/v3/environments',
  match_request_type         => 'path',
  match_request_method       => 'get',
  allow                      => 'your.special.admin',
  sort_order                 => 300,
  path                       => '/etc/puppetlabs/puppetserver/conf.d/auth.conf',
}
```

##### Delete the `environments` rule (from the previous example)

```puppet

# When removing a rule, you have only to provide the rule name and path to
# the configuration file where it can be found.
#
# Since rules must have unique names, you don't have to define the other
# attributes (`match_request_path`, etc); the rule with the matching name
# will be removed, regardless.
puppet_authorization::rule { 'environments':
  ensure                     => absent,
  path                       => '/etc/puppetlabs/puppetserver/conf.d/auth.conf',
}
```

##### Configure the catalog endpoint

```puppet

# You can configure the catalog HTTP endpoint for Puppet Server to:
#
#   * Permit an administrative node to access the catalog for any node.
#   * Permit other nodes to be able to access their own catalog, but no
#     other nodeâ€™s catalog.

# This example rule applies only to requests made to the `production` or
# `test` directory environments in Puppet:
puppet_authorization::rule { 'catalog_request':
  match_request_path         => '^/puppet/v3/catalog/([^/]+)$',
  match_request_type         => 'regex',
  match_request_method       => ['get','post'],
  match_request_query_params => {'environment' => [ 'production', 'test' ]},
  allow                      => ['$1', 'adminhost.mydomain.com'],
  sort_order                 => 200,
  path                       => '/etc/puppetlabs/puppetserver/conf.d/auth.conf',
}
```

#### Parameters

The following parameters are available in the `puppet_authorization::rule` defined type:

* [`match_request_path`](#match_request_path)
* [`match_request_type`](#match_request_type)
* [`path`](#path)
* [`ensure`](#ensure)
* [`rule_name`](#rule_name)
* [`allow`](#allow)
* [`deny`](#deny)
* [`allow_unauthenticated`](#allow_unauthenticated)
* [`match_request_method`](#match_request_method)
* [`match_request_query_params`](#match_request_query_params)
* [`sort_order`](#sort_order)

##### <a name="match_request_path"></a>`match_request_path`

Data type: `Optional[String]`



Default value: ``undef``

##### <a name="match_request_type"></a>`match_request_type`

Data type: `Optional[Enum['path', 'regex']]`

The type of match request

Default value: ``undef``

##### <a name="path"></a>`path`

Data type: `Stdlib::Absolutepath`

The absolute path for the auth.conf file.

##### <a name="ensure"></a>`ensure`

Data type: `Enum['present', 'absent']`

Whether to add or remove the rule

Default value: `'present'`

##### <a name="rule_name"></a>`rule_name`

Data type: `String`

The `name` setting for the rule

Default value: `$name`

##### <a name="allow"></a>`allow`

Data type: `Variant[Array[Variant[String, Hash]], String, Hash, Undef]`

The `allow` setting for the rule.

* Cannot be set along with an `allow_unauthenticated` value of true
* A hash here must contain only one of `extensions` or `certname`

For more details on the `allow` setting, see https://github.com/puppetlabs/trapperkeeper-authorization/blob/master/doc/authorization-config.md#allow

Default value: ``undef``

##### <a name="deny"></a>`deny`

Data type: `Variant[Array[Variant[String, Hash]], String, Hash, Undef]`

The `deny` setting for the rule.

* Cannot be set along with an`allow_unauthenticated` value of true.
* A hash here must contain only one of `extensions` or `certname`.

For more details on the
`deny` setting, see
https://github.com/puppetlabs/trapperkeeper-authorization/blob/master/doc/authorization-config.md#deny.

Default value: ``undef``

##### <a name="allow_unauthenticated"></a>`allow_unauthenticated`

Data type: `Boolean`

The `allow_unauthenticated` setting for the rule.

* Cannot be set to true along with `deny` or `allow`

Default value: ``false``

##### <a name="match_request_method"></a>`match_request_method`

Data type: `Variant[Array[Puppet_authorization::Httpmethod], Puppet_authorization::Httpmethod, Undef]`

The `method` setting for the `match_request` in the rule.

Valid options: String or array of strings containing: 'put', 'post', 'get', 'head', 'delete'.

Default value: ``undef``

##### <a name="match_request_query_params"></a>`match_request_query_params`

Data type: `Hash`

The `query_params` setting for the `match_request` in the rule

Default value: `{}`

##### <a name="sort_order"></a>`sort_order`

Data type: `Integer`

The sort order for the rule

Default value: `200`

## Resource types

### <a name="puppet_authorization_hocon_rule"></a>`puppet_authorization_hocon_rule`

An arbitrary name used as the identity of the resource.

#### Properties

The following properties are available in the `puppet_authorization_hocon_rule` type.

##### `ensure`

Valid values: `present`, `absent`

The basic property that the resource should be in.

Default value: `present`

##### `value`

The value of the setting to be defined.

#### Parameters

The following parameters are available in the `puppet_authorization_hocon_rule` type.

* [`name`](#name)
* [`path`](#path)
* [`provider`](#provider)

##### <a name="name"></a>`name`

namevar

An arbitrary name used as the identity of the resource.

##### <a name="path"></a>`path`

The file Puppet will ensure contains the specified setting.

##### <a name="provider"></a>`provider`

The specific backend to use for this `puppet_authorization_hocon_rule` resource. You will seldom need to specify this
--- Puppet will usually discover the appropriate provider for your platform.

## Data types

### <a name="puppet_authorizationhttpmethod"></a>`Puppet_authorization::Httpmethod`

HTTP method to authorize (`get`, `post`, etc.,)

Alias of

```puppet
Enum['put', 'post', 'get', 'head', 'delete']
```

